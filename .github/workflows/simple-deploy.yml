# GitHub Actions Workflow - DISABLED
# Manual upload to S3 required due to AWS credentials issues
# 
# To enable again:
# 1. Fix AWS credentials in GitHub Secrets
# 2. Uncomment the workflow below
# 3. Test deployment

# name: Simple Deploy
# 
# on:
#   push:
#     branches: [ main ]
# 
# jobs:
#   deploy:
#     runs-on: ubuntu-latest
#     
#     steps:
#     - name: Checkout code
#       uses: actions/checkout@v4
#       
#     - name: Setup Node.js
#       uses: actions/setup-node@v4
#       with:
#         node-version: '20'
#         cache: 'npm'
#         cache-dependency-path: 'frontend/package-lock.json'
#         
#     - name: Install dependencies
#       run: |
#         cd frontend
#         npm install
#         
#     - name: Build frontend
#       run: |
#         cd frontend
#         npm run build
#       env:
#         VITE_API_BASE_URL: https://placeholder.amazonaws.com/dev
#         
#     - name: List build files
#       run: |
#         cd frontend
#         ls -la dist/
#         echo "Build completed successfully!"
#         
#     - name: Configure AWS credentials
#       uses: aws-actions/configure-aws-credentials@v4
#       with:
#         aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
#         aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#         aws-region: ap-southeast-2
#         
#     - name: Test AWS connection
#       run: |
#         aws sts get-caller-identity
#         echo "‚úÖ AWS connection successful!"
#         
#     - name: Deploy to S3
#       run: |
#         cd frontend
#         aws s3 sync dist/ s3://staging-stock-market-chat-frontend-1758970542 --delete
#         
#     - name: Configure S3 for SPA routing
#       run: |
#         # Configure website hosting
#         aws s3api put-bucket-website \
#           --bucket staging-stock-market-chat-frontend-1758970542 \
#           --website-configuration '{
#             "IndexDocument": {"Suffix": "index.html"},
#             "ErrorDocument": {"Key": "index.html"}
#           }'
#         
#         # Set bucket policy for public read access
#         aws s3api put-bucket-policy \
#           --bucket staging-stock-market-chat-frontend-1758970542 \
#           --policy '{
#             "Version": "2012-10-17",
#             "Statement": [
#               {
#                 "Sid": "PublicReadGetObject",
#                 "Effect": "Allow",
#                 "Principal": "*",
#                 "Action": "s3:GetObject",
#                 "Resource": "arn:aws:s3:::staging-stock-market-chat-frontend-1758970542/*"
#               }
#             ]
#           }'
#         
#         # Enable public access
#         aws s3api put-public-access-block \
#           --bucket staging-stock-market-chat-frontend-1758970542 \
#           --public-access-block-configuration "BlockPublicAcls=false,IgnorePublicAcls=false,BlockPublicPolicy=false,RestrictPublicBuckets=false"
#         
#         echo "‚úÖ S3 configured for SPA routing with public access"
#         
#     - name: Success message
#       run: |
#         echo "üéâ Deployment completed successfully!"
#         echo "üåê Website: http://staging-stock-market-chat-frontend-1758970542.s3-website-ap-southeast-2.amazonaws.com"
#         echo "üåê Custom Domain: http://stockai.gavinadlan.my.id"